# Основы объектно-ориентированного программирования

## Три столпа парадигдмы ООП
- Инкапсуляция
- Наследование
- Полиморфизм

## Инкапсуляция
Инкапсуляция (encapsulation) – объединение данных
вместе с механизмами и методами, работающими с ними, а
также ограничение прямого доступа к данным как к
компонентам объекта

```
CALL a%proc(x,y)
объект a передаётся как первый параметр в процедуру proc
● Это явно подчёркивается:
PROCEDURE, PASS :: proc
● Объект можно не передавать:
PROCEDURE, NOPASS, POINTER :: p
● Можно явно указать его название:
PROCEDURE, PASS(arg) :: proc3
```
Пример
```
TYPE T
  private
...
contains
  procedure :: proc => my_proc
  procedure :: proc2
  GENERIC :: gen => proc3, proc4, proc5 ! перегрузка процедуры
end type T

type(T) a

call a%proc(x,y)

call a%gen(x,y,z) ! proc3
call a%gen(x,y)   ! proc4
call a%gen(x)     ! proc5
call a%gen()      ! xxx - такую процедуру не создавали
```

### Отложенное связывание и абстрактные типы
- Ситуация – ожидается, что процедура, привязанная к типу,
будет вызываться только для потомка типа, который
переопределяет процедуру
- Процедура, привязанная к типу, не имеет реализации по
умолчанию или естественной реализации, а имеет только
четко определенную цель и интерфейс
- Такое поведение может быть обеспечено объявлением типа
как абстрактного, а привязки как отложенной
- Для связанной процедуры требуется интерфейс
```
TYPE, ABSTRACT :: FILE_HANDLE
 CONTAINS
    PROCEDURE (OPEN_FILE), DEFERRED, PASS :: OPEN
! эквивалентно procedure :: proc => my_proc
! DEFERRED - отложенное связывание
    ...
 END TYPE
 ABSTRACT INTERFACE
    SUBROUTINE OPEN_FILE(HANDLE)
       CLASS(FILE_HANDLE), INTENT(INOUT) :: HANDLE
    END SUBROUTINE OPEN_FILE
 END INTERFACE
 
 type, extends(FILE_HANDLE) :: vfs_handle
 CONTAINS
    PROCEDURE, PASS :: OPEN
 end type vfs_handle
 
 procedure Open(Handle)
    class(FILE_HANDLE), intent(inout) :: Handle
    ! type(vfs_handle), intent(inout) :: Handle
    ...
 end procedure Open
 
 type(vfs_handle) :: vfs_h
 
 vfs_h%Open 
```
## Наследование
Наследование (Inheritance) – это механизм базирования
объекта на другом объекте с сохранением аналогичной
реализации

## Полиморфизм
Полиморфизм (Polymorphism) – это предоставление
единого интерфейса для объектов разных типов или
использование одного символа для представления
нескольких различных типов
Три вида полиморфизма:
- Ad-hoc-полиморфизм (специальный полиморфизм)
- Параметрический полиморфизм (parametric polymorphism)
- Полиморфизм включения (inclusion polymorphism)

### Ad-hoc-полиморфизм
- Определяет общий интерфейс для произвольного набора
индивидуально заданных типов
- Реализуется через переопределение процедур

### Параметрический полиморфизм
Не указывая конкретные типы, а вместо этого используя
абстрактные символы, которые могут заменить любой тип

**Обобщённое программирование (generic programming)** –
парадигма программирования, в которой код написан в
терминах типов, которые будут указаны позже, при этом
описание данных и алгоритмов можно без изменений
применять к различным типам данных

### Переопределение процедуры
- Процедура в потомке может быть переопределена
(overridden)
- Его можно запретить:
PROCEDURE, NON_OVERRIDABLE :: proc2

### Завершающие процедуры
- Производный тип является завершаемым (finalizable), если у
него есть какая-либо завершающая подпрограмма
- Их назначение — выполнять операции очистки, такие как
освобождение целевых объектов компонентов ссылки, когда
объект типа перестает существовать
